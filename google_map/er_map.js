Jsfiddle: http: //jsfiddle.net/cfbh9va8/8/show/

  function createMarker(width, height, title) {
    var canvas, context, radius = 4;
    canvas = document.createElement("canvas");
    canvas.width = width;
    canvas.height = height;
    context = canvas.getContext("2d");
    context.clearRect(0, 0, width, height);
    if (title > 50) {
      context.fillStyle = "rgb(10,101,134)";
    } else {
      context.fillStyle = "rgb(0,191,255)";
    }
    context.strokeStyle = "rgb(0,0,0)";
    context.beginPath();
    context.moveTo(radius, 0);
    context.lineTo(width - radius, 0);
    context.quadraticCurveTo(width, 0, width, radius);
    context.lineTo(width, height - radius);
    context.quadraticCurveTo(width, height, width - radius, height);
    context.lineTo(radius, height);
    context.quadraticCurveTo(0, height, 0, height - radius);
    context.lineTo(0, radius);
    context.quadraticCurveTo(0, 0, radius, 0);
    context.closePath();
    context.fill();
    context.stroke();
    context.font = "bold 10pt Arial"
    context.textAlign = "center";
    context.fillStyle = "rgb(255,255,255)";
    context.fillText(title, 15, 15);
    return canvas.toDataURL();
  }

function createMarker2(width, height, title, title2) {
  var canvas, context, radius = 4;
  canvas = document.createElement("canvas");
  canvas.width = width;
  canvas.height = height;
  context = canvas.getContext("2d");
  context.clearRect(0, 0, width, height);

  if (title2 > 0.85) {
    context.fillStyle = "rgb(162,10,10)";
  } else {
    context.fillStyle = "rgb(255,10,10)";
  }

  context.strokeStyle = "rgb(0,0,0)";
  context.beginPath();
  context.moveTo(radius, 0);
  context.lineTo(width - radius, 0);
  context.quadraticCurveTo(width, 0, width, radius);
  context.lineTo(width, height - radius);
  context.quadraticCurveTo(width, height, width - radius, height);
  context.lineTo(radius, height);
  context.quadraticCurveTo(0, height, 0, height - radius);
  context.lineTo(0, radius);
  context.quadraticCurveTo(0, 0, radius, 0);
  context.closePath();
  context.fill();
  context.stroke();
  context.font = "bold 10pt Arial"
  context.textAlign = "center";
  context.fillStyle = "rgb(255,255,255)";
  context.fillText(title, 15, 15);
  return canvas.toDataURL();
}

var visitmarkers = [];
var locations = [

  [49.379757, -121.443415, 364, ''],
  [49.358935, -121.464833, 326, 'Cancer'],
  [49.091426, -123.053456, 114, 'MHSU'],
  [49.38202, -121.404963, 111, 'Cancer'],
  [49.375622, -121.43547, 93, ''],
  [49.188899, -122.882588, 85, 'Infectious Disease'],
  [49.234878, -121.752582, 64, 'Cancer'],
  [49.170936, -122.864015, 61, ''],
  [49.090251, -123.089275, 59, 'Cancer'],
  [49.17146, -121.943948, 52, 'Cancer'],
  [49.176951, -122.842438, 50, ''],
  [49.384286, -121.459374, 50, 'MHSU'],
  [49.235381, -121.767159, 44, ''],
  [49.242042, -121.770461, 38, ''],
  [49.17392, -122.081833, 37, ''],
  [49.035174, -122.779039, 36, ''],
  [49.185923, -122.836217, 35, ''],
  [49.149122, -122.262954, 34, ''],
  [49.249747, -122.860653, 29, 'Infectious Disease'],
  [49.174277, -121.956123, 27, 'MHSU'],
  [49.168692, -121.964712, 26, 'Infectious Disease'],
  [49.135225, -122.304319, 25, 'Cancer'],
  [49.563217, -121.432989, 25, 'Cancer'],
  [49.028142, -123.081041, 23, 'MHSU'],
  [49.089631, -123.07829, 23, 'Infectious Disease'],
  [49.176065, -122.805163, 23, 'MHSU'],
  [49.300141, -121.785316, 22, 'Cancer'],
  [49.166621, -121.941178, 22, 'Cancer'],
  [49.238666, -121.760464, 22, 'MHSU'],
  [49.033405, -123.059604, 21, 'MHSU'],
  [49.2361, -122.846566, 21, 'Infectious Disease'],
  [49.176558, -121.935272, 21, ''],
  [49.051294, -122.298421, 21, 'Cancer'],
  [49.168928, -121.96261, 21, ''],
  [49.137318, -122.332569, 20, ''],
  [49.864001, -121.442582, 19, 'Infectious Disease'],
  [49.135507, -122.332563, 19, 'Infectious Disease'],
  [49.102747, -123.075891, 18, 'MHSU'],
  [49.182288, -121.804758, 18, ''],
  [49.168077, -121.96177, 18, 'Infectious Disease'],
  [49.18576, -121.772016, 18, 'MHSU'],
  [49.176955, -121.926898, 18, ''],
  [49.049404, -122.804122, 17, ''],
  [49.091114, -123.050197, 17, 'Cancer'],
  [49.092737, -123.07595, 17, 'MHSU'],
  [49.079064, -123.126512, 17, 'Infectious Disease'],
  [49.038293, -122.31213, 17, ''],
  [49.18549, -121.868681, 17, ''],
  [49.174157, -121.956523, 17, 'MHSU'],
  [49.086291, -123.081008, 16, 'Cancer'],
  [49.118077, -122.892457, 16, 'Infectious Disease'],
  [49.246786, -122.748161, 16, ''],
  [49.165733, -121.960445, 16, ''],
  [49.160645, -121.965786, 16, 'Infectious Disease'],
  [49.181247, -121.901113, 16, 'Infectious Disease'],
  [49.167448, -121.959694, 16, 'Infectious Disease'],
  [49.171541, -121.962546, 16, ''],
  [49.115503, -122.685465, 15, 'MHSU'],
  [49.136334, -122.312369, 15, 'Cancer'],
  [49.165951, -121.963066, 15, 'MHSU'],
  [49.173546, -121.949419, 15, 'Cancer'],
  [49.169193, -121.932434, 15, ''],
  [49.170066, -121.933485, 15, 'Cancer'],
  [49.151005, -122.29138, 15, ''],
  [49.172568, -121.949757, 15, ''],
  [49.154943, -121.95153, 15, 'MHSU'],
  [49.026716, -123.06888, 14, 'Cancer'],
  [49.008343, -123.074249, 14, 'MHSU'],
  [49.026256, -122.79962, 14, 'Cancer'],
  [49.121386, -122.845745, 14, ''],
  [49.288256, -122.750408, 14, 'Cancer'],
  [49.217224, -122.633523, 14, 'Cancer'],
  [49.038103, -122.312863, 14, 'MHSU'],
  [49.106089, -121.956941, 14, 'Cancer'],
  [49.168966, -121.959935, 14, ''],
  [49.061961, -122.810566, 13, 'Infectious Disease'],
  [49.028833, -122.806574, 13, 'Cancer'],
  [49.045554, -122.808223, 13, ''],
  [49.186209, -122.852528, 13, 'MHSU'],
  [49.023973, -122.802559, 13, ''],
  [49.27621, -122.819333, 13, 'Cancer'],
  [49.147162, -121.833208, 13, 'Infectious Disease'],
  [49.164936, -121.961915, 13, 'MHSU'],
  [49.134544, -122.318365, 13, 'Cancer'],
  [49.219179, -122.604666, 13, 'Infectious Disease'],
  [49.175847, -121.814274, 13, 'MHSU'],
  [49.209483, -122.986014, 12, 'MHSU'],
  [49.280258, -122.984728, 12, 'Cancer'],
  [49.031249, -122.779051, 12, 'Cancer'],
  [49.197036, -122.847026, 12, 'Infectious Disease'],
  [49.202996, -122.851819, 12, 'Infectious Disease'],
  [49.101669, -122.65958, 12, 'MHSU'],
  [49.245313, -122.804747, 12, 'Cancer'],
  [49.196516, -122.799354, 12, ''],
  [49.230003, -122.80761, 12, ''],
  [49.145573, -122.297697, 12, 'MHSU'],
  [49.078778, -121.966942, 12, 'Infectious Disease'],
  [49.049064, -122.317975, 12, ''],
  [49.150551, -122.299639, 12, 'Cancer'],
  [49.210573, -122.594388, 12, 'Cancer'],
  [49.157814, -121.998678, 12, ''],
  [49.169801, -121.939834, 12, ''],
  [49.03826, -122.314129, 12, 'Cancer'],
  [49.073327, -122.311445, 12, 'Cancer'],
  [49.159588, -122.324965, 11, ''],
  [49.163808, -122.903634, 11, ''],
  [49.140281, -122.407082, 11, 'MHSU'],
  [49.099637, -123.077629, 11, 'MHSU'],
  [49.172081, -122.914573, 11, 'Infectious Disease'],
  [49.064514, -122.841923, 11, 'MHSU'],
  [49.036831, -122.713252, 11, 'Cancer'],
  [49.211784, -122.6793, 11, 'MHSU'],
  [49.181238, -122.834478, 11, ''],
  [49.178073, -122.851172, 11, 'Infectious Disease'],
  [49.151317, -122.845335, 11, 'Cancer'],
  [49.138017, -121.951435, 11, 'Cancer'],
  [49.173593, -121.96078, 11, 'MHSU'],
  [49.156371, -121.945412, 11, 'MHSU'],
  [49.138947, -122.318017, 11, 'MHSU'],
  [49.173927, -121.945545, 11, 'Cancer'],
  [49.162038, -121.937262, 11, 'MHSU'],
  [49.217916, -122.645251, 11, ''],
  [49.156379, -121.951563, 11, 'Infectious Disease'],
  [49.051957, -122.334489, 11, ''],
  [49.165504, -121.963828, 11, 'MHSU'],
  [49.288448, -123.021669, 10, ''],
  [49.230819, -122.991829, 10, 'Infectious Disease'],
  [49.242318, -123.004837, 10, 'MHSU'],
  [49.157303, -122.921146, 10, 'MHSU'],
  [49.099181, -123.072817, 10, 'Cancer'],
  [49.084159, -123.074057, 10, 'MHSU'],
  [49.106444, -122.825663, 10, 'MHSU'],
  [49.033516, -122.834492, 10, 'MHSU'],
  [49.040633, -122.78666, 10, 'Cancer'],
  [49.172829, -122.884548, 10, 'MHSU'],
  [49.15475, -122.820069, 10, ''],
  [49.123297, -122.810525, 10, 'Infectious Disease'],
  [49.124359, -122.84938, 10, 'Infectious Disease'],
  [49.219161, -122.607174, 10, ''],
  [49.047431, -122.283291, 10, 'MHSU'],
  [49.135982, -122.318045, 10, 'MHSU'],
  [49.228177, -122.013241, 10, 'MHSU'],
  [49.167601, -121.96408, 10, 'MHSU'],
  [49.170336, -121.963463, 10, ''],
  [49.161165, -121.963449, 10, 'Cancer'],
  [49.27695, -121.240531, 10, 'Infectious Disease'],
  [49.161364, -121.962405, 10, 'Infectious Disease'],
  [49.057451, -122.326489, 10, 'MHSU'],
  [49.06497, -122.35862, 10, ''],
  [49.159867, -121.969083, 10, 'Cancer'],
];

var GPmarkers = [];
var GPlocations = [
  [49.238666, -121.760464, 5, 0.97],
  [49.234878, -121.752582, 1, 0.8],
  [49.235381, -121.767159, 1, 1],
  [49.379757, -121.443415, 10, 0.86],
  [49.375622, -121.43547, 1, 0.92],
  [49.164881, -122.665415, 4, 0.91],
  [49.162419, -122.633885, 2, 0.82],
  [49.169487, -122.577894, 7, 0.99],
  [49.169487, -122.577894, 2, 0.91],
  [49.1618, -122.656761, 1, 1],
  [49.165347, -122.661974, 3, 0.8],
  [49.167348, -121.963078, 7, 0.94],
  [49.165951, -121.963066, 9, 0.89],
  [49.167993, -121.957915, 1, 0.82],
  [49.167081, -121.958593, 6, 0.94],
  [49.171139, -121.952374, 2, 0.83],
  [49.171789, -121.949989, 1, 0.92],
  [49.183679, -121.940796, 1, 0.96],
  [49.167121, -121.967628, 1, 0.95],
  [49.166716, -121.967421, 1, 0.87],
  [49.167543, -121.965903, 2, 0.87],
  [49.16573, -121.963789, 3, 0.93],
  [49.16937, -121.959326, 2, 0.95],
  [49.168041, -121.960627, 8, 1],
  [49.168053, -121.960328, 3, 0.8],
  [49.169416, -121.952614, 1, 0.91],
  [49.168293, -121.959526, 1, 0.8],
  [49.169121, -121.957077, 5, 1],
  [49.124052, -121.959889, 4, 1],
  [49.105227, -121.964951, 1, 0.87],
  [49.154852, -121.978097, 4, 0.93],
  [49.103876, -121.958323, 1, 1],
  [49.141679, -121.967358, 3, 0.92],
  [49.139656, -121.965599, 3, 0.82],
  [49.136375, -121.957994, 4, 0.86],
  [49.140061, -121.959836, 3, 0.91],
  [49.134819, -121.959812, 2, 0.88],
  [49.093547, -121.951845, 1, 0.91],
  [49.111104, -121.957824, 1, 0.97],
  [49.111211, -121.956955, 5, 0.87],
  [49.041139, -122.297229, 1, 0.85],
  [49.038103, -122.312863, 6, 0.93],
  [49.038907, -122.292338, 1, 0.83],
  [49.049879, -122.301125, 1, 0.97],
  [49.038818, -122.269602, 4, 0.93],
  [49.037629, -122.293434, 3, 0.89],
  [49.039528, -122.293207, 1, 0.8],
  [49.039835, -122.293487, 11, 0.84],
  [49.040984, -122.293514, 3, 0.85],
  [49.040984, -122.293514, 8, 0.88],
  [49.041904, -122.293536, 1, 1],
  [49.044593, -122.293328, 1, 0.81],
  [49.046903, -122.293688, 4, 0.89],
  [49.045445, -122.283919, 1, 0.91],
  [49.052197, -122.31143, 4, 0.93],
  [49.057199, -122.271949, 3, 0.9],
  [49.060578, -122.3787, 5, 0.82],
  [49.065735, -122.379559, 1, 0.86],
  [49.046241, -122.331568, 1, 0.89],
  [49.047876, -122.33528, 2, 0.93],
  [49.051395, -122.320446, 4, 0.84],
  [49.050723, -122.337838, 3, 0.95],
  [49.049689, -122.331088, 1, 0.97],
  [49.052566, -122.319761, 3, 0.82],
  [49.052412, -122.320039, 1, 0.92],
  [49.049821, -122.335608, 2, 0.97],
  [49.053177, -122.325235, 3, 0.98],
  [49.050972, -122.317534, 4, 0.89],
  [49.054896, -122.325725, 2, 0.91],
  [49.054236, -122.358929, 2, 0.92],
  [49.053822, -122.32399, 1, 0.83],
  [49.055608, -122.315448, 1, 0.93],
  [49.053916, -122.324267, 6, 0.85],
  [49.054222, -122.315549, 2, 0.82],
  [49.045445, -122.283919, 1, 0.93],
  [49.133089, -122.325048, 3, 0.83],
  [49.13288, -122.336507, 9, 0.83],
  [49.139909, -122.295506, 3, 0.9],
  [49.135472, -122.332838, 2, 0.86],
  [49.136584, -122.332838, 4, 0.81],
  [49.133855, -122.330866, 10, 0.94],
  [49.139476, -122.313473, 1, 0.99],
  [49.133662, -122.322283, 1, 0.96],
  [49.133086, -122.327003, 6, 1],
  [49.217916, -122.645251, 1, 0.82],
  [49.21593, -122.608472, 1, 0.98],
  [49.218345, -122.650245, 5, 0.87],
  [49.218536, -122.650361, 12, 0.88],
  [49.215434, -122.589664, 4, 0.88],
  [49.213623, -122.587735, 1, 0.8],
  [49.2049, -122.581099, 1, 0.91],
  [49.218847, -122.592486, 1, 0.85],
  [49.220593, -122.608043, 11, 0.82],
  [49.214502, -122.631787, 3, 0.86],
  [49.219954, -122.590638, 1, 0.95],
  [49.217916, -122.645251, 1, 0.84],
  [49.217916, -122.645251, 1, 0.8],
  [49.220522, -122.599741, 5, 0.93],
  [49.096425, -122.610419, 1, 0.86],
  [49.116413, -122.668841, 3, 0.98],
  [49.115753, -122.678889, 2, 0.83],
  [49.11691, -122.671056, 4, 0.9],
  [49.12251, -122.660025, 5, 0.86],
  [49.158466, -122.667698, 1, 0.98],
  [49.144033, -122.630246, 1, 0.94],
  [49.098516, -122.604081, 1, 0.83],
  [49.096778, -122.611424, 13, 0.85],
  [49.075431, -122.667846, 4, 0.82],
  [49.102793, -122.651836, 1, 0.85],
  [49.074766, -122.665929, 2, 0.8],
  [49.075978, -122.667628, 1, 0.92],
  [49.089287, -122.604417, 3, 0.81],
  [49.103106, -122.653426, 3, 0.93],
  [49.102294, -122.650515, 1, 0.98],
  [49.10593, -122.649259, 1, 0.89],
  [49.105182, -122.658966, 1, 0.83],
  [49.103255, -122.649446, 1, 1],
  [49.103223, -122.650171, 1, 0.97],
  [49.102519, -122.647952, 1, 0.98],
  [49.093119, -122.613371, 4, 0.89],
  [49.109399, -122.6488, 5, 0.82],
  [49.102754, -122.656739, 5, 0.89],
  [49.090844, -122.606097, 2, 0.94],
  [49.108787, -122.650215, 2, 0.9],
  [49.102863, -122.651486, 5, 0.8],
  [49.08753, -122.64581, 1, 0.97],
  [49.284444, -122.79577, 3, 0.8],
  [49.282801, -122.798072, 1, 1],
  [49.284175, -122.795631, 2, 0.8],
  [49.282692, -122.795277, 1, 0.9],
  [49.254532, -122.738273, 3, 0.96],
  [49.264474, -122.768816, 1, 0.84],
  [49.27781, -122.804649, 1, 0.88],
  [49.274211, -122.792659, 5, 0.87],
  [49.271309, -122.751309, 1, 0.89],
  [49.277582, -122.80271, 2, 0.83],
  [49.277582, -122.80271, 1, 0.81],
  [49.273256, -122.789445, 6, 0.87],
  [49.278957, -122.791749, 4, 0.82],
  [49.272503, -122.755011, 8, 0.97],
  [49.275955, -122.795907, 8, 1],
  [49.282349, -122.801473, 1, 0.89],
  [49.282179, -122.795965, 2, 0.93],
  [49.278939, -122.803794, 1, 0.94],
  [49.27322, -122.789362, 1, 0.85],
  [49.246786, -122.748161, 2, 0.95],
  [49.263032, -122.778705, 6, 0.94],
  [49.270713, -122.791993, 7, 0.93],
  [49.246955, -122.813214, 1, 0.97],
  [49.230003, -122.80761, 2, 0.9],
  [49.260985, -122.777071, 13, 0.88],
  [49.29301, -122.757904, 4, 0.81],
  [49.29612, -122.804481, 2, 0.88],
  [49.042352, -122.223268, 6, 0.91],
  [49.276632, -122.855353, 1, 0.99],
  [49.276814, -122.855754, 1, 0.8],
  [49.28411, -122.822603, 3, 0.95],
  [49.310725, -122.844077, 1, 0.98],
  [49.283945, -122.825886, 7, 0.99],
  [49.253716, -122.902277, 1, 0.85],
  [49.253355, -122.897461, 2, 0.91],
  [49.246066, -122.893307, 1, 0.93],
  [49.249137, -122.895469, 6, 0.91],
  [49.249137, -122.895469, 1, 0.91],
  [49.254775, -122.884846, 1, 0.88],
  [49.256253, -122.854753, 1, 0.96],
  [49.258965, -122.891742, 1, 0.91],
  [49.258782, -122.8924, 3, 0.82],
  [49.226926, -122.848736, 1, 0.98],
  [49.253362, -122.898214, 8, 0.84],
  [49.249128, -122.866627, 10, 0.88],
  [49.249093, -122.858592, 8, 0.94],
  [49.248896, -122.854946, 1, 0.96],
  [49.245109, -122.892455, 1, 0.81],
  [49.248091, -122.892553, 11, 0.8],
  [49.23355, -122.856372, 8, 0.9],
  [49.239814, -122.878261, 1, 0.93],
  [49.215384, -122.901487, 1, 0.97],
  [49.216601, -122.903226, 2, 0.86],
  [49.203478, -122.90711, 5, 0.95],
  [49.214746, -122.921277, 1, 0.87],
  [49.21629, -122.913552, 1, 0.84],
  [49.205118, -122.90472, 1, 0.85],
  [49.211107, -122.917604, 1, 0.83],
  [49.213394, -122.920837, 4, 0.84],
  [49.214028, -122.921628, 1, 0.84],
  [49.225288, -122.89301, 1, 0.89],
  [49.225822, -122.893013, 13, 0.86],
  [49.226608, -122.892705, 5, 1],
  [49.212423, -122.919265, 9, 0.83],
  [49.215251, -122.896038, 1, 1],
  [49.200264, -122.916571, 1, 0.91],
  [49.206874, -122.913392, 1, 1],
  [49.211165, -122.919887, 1, 0.94],
  [49.202217, -122.949252, 2, 0.85],
  [49.201284, -122.916215, 2, 0.8],
  [49.200231, -122.915857, 1, 0.89],
  [49.219051, -122.950634, 14, 0.99],
  [49.219201, -122.949894, 2, 0.82],
  [49.224698, -122.93965, 1, 0.96],
  [49.2224, -122.931753, 1, 0.98],
  [49.219168, -122.92805, 7, 0.99],
  [49.234454, -122.917493, 1, 0.89],
  [49.187322, -122.79936, 3, 0.81],
  [49.191373, -122.814556, 2, 0.8],
  [49.191359, -122.810297, 1, 0.98],
  [49.191351, -122.804651, 2, 0.87],
  [49.198829, -122.810196, 3, 0.91],
  [49.166359, -122.802401, 1, 0.99],
  [49.163967, -122.796331, 1, 0.8],
  [49.164946, -122.801206, 3, 0.85],
  [49.167503, -122.801122, 5, 0.91],
  [49.1879, -122.799637, 3, 0.99],
  [49.189437, -122.795467, 2, 0.84],
  [49.199618, -122.844183, 1, 0.98],
  [49.193214, -122.797718, 5, 0.81],
  [49.188164, -122.800703, 3, 0.99],
  [49.193031, -122.802879, 2, 0.84],
  [49.184299, -122.798788, 2, 0.83],
  [49.184278, -122.803123, 3, 0.96],
  [49.061133, -122.798312, 8, 0.85],
  [49.104569, -122.798665, 3, 0.85],
  [49.104019, -122.729697, 7, 0.95],
  [49.126439, -122.797072, 1, 0.86],
  [49.133609, -122.804597, 4, 0.87],
  [49.049123, -122.783294, 8, 0.84],
  [49.10653, -122.757832, 2, 0.92],
  [49.10425, -122.739464, 6, 0.99],
  [49.118198, -122.801198, 1, 0.8],
  [49.104713, -122.730449, 3, 0.88],
  [49.102882, -122.800855, 1, 0.86],
  [49.104246, -122.797376, 7, 0.94],
  [49.118632, -122.690234, 1, 0.98],
  [49.049801, -122.78922, 1, 0.93],
  [49.125135, -122.705308, 2, 0.96],
  [49.126432, -122.707945, 3, 0.95],
  [49.104592, -122.804711, 8, 1],
  [49.187968, -122.848733, 1, 0.85],
  [49.191767, -122.851001, 1, 0.83],
  [49.191586, -122.825007, 1, 0.83],
  [49.1797, -122.834, 13, 0.91],
  [49.191624, -122.838709, 3, 0.85],
  [49.178065, -122.84539, 1, 0.85],
  [49.185921, -122.845674, 5, 0.96],
  [49.193822, -122.84556, 1, 0.92],
  [49.197066, -122.845546, 5, 0.8],
  [49.178094, -122.867794, 1, 0.83],
  [49.185338, -122.843355, 3, 0.93],
  [49.186755, -122.843078, 1, 0.94],
  [49.178426, -122.843454, 2, 0.81],
  [49.196437, -122.845063, 2, 0.99],
  [49.181572, -122.839824, 1, 0.94],
  [49.199007, -122.850257, 5, 0.98],
  [49.177134, -122.842734, 6, 0.91],
  [49.170173, -122.842202, 2, 0.82],
  [49.174569, -122.842893, 10, 0.99],
  [49.176951, -122.842438, 19, 0.98],
  [49.209041, -122.872627, 1, 0.87],
  [49.170078, -122.890083, 1, 0.87],
  [49.176476, -122.889984, 1, 0.9],
  [49.177051, -122.865754, 5, 0.86],
  [49.177236, -122.866407, 1, 0.84],
  [49.148252, -122.86491, 1, 0.83],
  [49.136025, -122.842668, 2, 0.97],
  [49.161867, -122.88858, 5, 0.94],
  [49.150332, -122.865577, 1, 0.85],
  [49.133782, -122.877475, 2, 0.83],
  [49.133674, -122.864087, 2, 0.91],
  [49.133683, -122.84177, 1, 0.98],
  [49.139662, -122.845399, 4, 0.81],
  [49.14111, -122.867156, 5, 0.99],
  [49.140824, -122.85427, 1, 0.99],
  [49.163073, -122.875029, 5, 0.83],
  [49.162689, -122.863889, 1, 0.84],
  [49.162644, -122.847984, 3, 0.88],
  [49.131323, -122.890156, 20, 0.83],
  [49.1414, -122.890166, 2, 0.97],
  [49.150391, -122.890188, 1, 0.89],
  [49.154098, -122.890173, 1, 0.98],
  [49.160638, -122.890113, 4, 0.9],
  [49.151742, -122.888667, 1, 0.94],
  [49.130872, -122.867644, 2, 1],
  [49.153817, -122.867815, 1, 0.91],
  [49.128404, -122.845293, 1, 0.85],
  [49.148965, -122.845436, 1, 0.93],
  [49.134747, -122.839319, 1, 0.92],
  [49.133708, -122.839048, 4, 0.85],
  [49.115577, -122.83065, 3, 0.89],
  [49.106444, -122.825663, 1, 0.86],
  [49.117895, -122.845658, 2, 0.92],
  [49.098735, -122.868969, 1, 0.92],
  [49.22435, -122.689383, 4, 0.86],
  [49.236758, -122.704582, 1, 0.9],
  [49.231925, -122.692137, 5, 0.87],
  [49.222515, -122.691186, 1, 0.95],
  [49.222708, -122.670946, 1, 0.98],
  [49.061133, -122.798312, 2, 0.85],
  [49.049123, -122.783294, 1, 0.95],
  [49.031208, -122.863544, 1, 0.96],
  [49.031245, -122.813465, 1, 0.92],
  [49.031255, -122.798865, 14, 0.89],
  [49.045735, -122.795537, 7, 0.96],
  [49.045476, -122.796403, 6, 0.94],
  [49.053222, -122.880464, 5, 0.98],
  [49.032677, -122.801424, 1, 1],
  [49.039232, -122.801334, 4, 0.91],
  [49.04299, -122.88001, 1, 0.83],
  [49.034379, -122.803478, 1, 0.88],
  [49.037276, -122.801356, 1, 0.87],
  [49.026057, -122.81493, 4, 0.93],
  [49.016978, -122.791102, 1, 0.94],
  [49.021286, -122.792876, 1, 0.97],
  [49.029341, -122.792914, 9, 0.81],
  [49.02935, -122.795201, 14, 0.95],
  [49.030142, -122.812083, 1, 0.9],
  [49.028163, -122.79961, 6, 0.91],
  [49.030258, -122.79961, 1, 0.8],
  [49.138641, -122.890572, 3, 0.98],
  [49.173605, -122.890411, 2, 0.91],
  [49.140364, -122.890584, 1, 0.89],
  [49.163327, -122.894335, 2, 0.81],
  [49.163133, -122.891886, 4, 0.88],
  [49.137606, -122.890562, 1, 0.83],
  [49.151288, -122.891842, 4, 0.89],
  [49.149088, -122.890585, 1, 0.86],
  [49.158502, -122.890589, 6, 0.84],
  [49.16095, -122.89057, 4, 0.88],
  [49.165514, -122.890522, 3, 0.8],
  [49.119288, -122.893908, 1, 0.89],
  [49.129286, -122.892759, 1, 0.84],
  [49.118391, -122.89063, 2, 0.86],
  [49.129175, -122.890591, 6, 0.99],
  [49.132802, -122.890575, 1, 1],
  [49.089337, -123.084196, 4, 0.81],
  [49.090154, -123.079522, 5, 0.85],
  [49.092051, -123.085936, 5, 0.88],
  [49.091257, -122.95883, 1, 0.93],
  [49.084834, -123.061787, 1, 0.98],
  [49.08494, -123.064462, 10, 0.83],
  [49.023128, -123.068881, 7, 0.98],
  [49.029263, -123.0681, 4, 0.84],
  [49.024606, -123.073075, 1, 0.8],
  [49.024788, -123.074233, 3, 0.8],
  [49.002563, -123.073127, 1, 0.86],
  [49.021914, -123.073646, 1, 0.91],
  [49.15541, -122.775144, 6, 0.86],
  [49.159621, -122.779043, 4, 0.93],
  [49.198904, -122.775201, 1, 0.89],
  [49.169292, -122.779019, 3, 0.8],
  [49.198705, -122.78, 3, 0.85],
  [49.060948, -122.812304, 4, 0.87],
  [49.236588, -122.540382, 1, 0.8],
  [49.221208, -122.561635, 3, 0.8],
  [49.058101, -122.477324, 1, 0.88],
  [49.058296, -122.473313, 1, 0.98],
  [49.059576, -122.470855, 3, 0.88],
  [49.058539, -122.381219, 4, 0.89],
  [49.078645, -122.367121, 1, 0.84],
  [49.039082, -122.395377, 1, 0.86],
  [49.272405, -122.918478, 3, 0.82],
  [49.252664, -122.966749, 1, 0.8],
  [49.280248, -122.982871, 1, 1],
  [49.280221, -122.966162, 9, 0.82],
  [49.264359, -123.009528, 1, 0.85],
  [49.280962, -123.015202, 11, 0.82],
  [49.28112, -123.007074, 4, 0.98],
  [49.281113, -123.004741, 3, 0.84],
  [49.28108, -122.998187, 5, 0.88],
  [49.26659, -123.005345, 3, 0.8],
  [49.266537, -123.002829, 5, 0.82],
  [49.267965, -123.00484, 1, 0.96],
  [49.280983, -123.017835, 2, 0.82],
  [49.268151, -123.005715, 1, 0.88],
  [49.218333, -122.958045, 1, 0.97],
  [49.218286, -122.953688, 4, 0.97],
  [49.22469, -122.94195, 1, 0.85],
  [49.219625, -122.956062, 1, 0.94],
  [49.249794, -123.018915, 6, 0.83],
  [49.248902, -123.016345, 8, 0.97],
  [49.253705, -123.004485, 2, 0.87],
  [49.240737, -122.986519, 2, 0.94],
  [49.244589, -122.972793, 1, 0.82],
  [49.227743, -122.997055, 2, 0.81],
  [49.226651, -122.995514, 1, 0.95],
  [49.226057, -123.005448, 1, 0.8],
  [49.231987, -123.004932, 1, 0.97],
  [49.232864, -123.016676, 5, 0.95],
  [49.230714, -123.006035, 8, 0.94],
  [49.229831, -123.003959, 3, 0.99],
  [49.229595, -123.002983, 1, 0.89],
  [49.228739, -123.000104, 4, 0.83],
  [49.226112, -122.992676, 1, 0.91],
  [49.224994, -122.989227, 1, 0.85],
  [49.224359, -123.00677, 1, 0.95],
  [49.22425, -123.004574, 2, 0.96],
  [49.225896, -122.988794, 1, 0.97],
  [49.232056, -123.010161, 3, 0.82],
  [49.225528, -122.994335, 1, 0.98],
  [49.23055, -122.99466, 1, 0.85],
  [49.223752, -122.998889, 5, 0.99],
  [49.229638, -122.998258, 1, 0.9],
  [49.226201, -122.992949, 2, 0.97],
  [49.227162, -123.005124, 5, 0.95],
  [49.227277, -122.995616, 4, 0.89],
  [49.229638, -122.998258, 1, 0.83],
  [49.254546, -123.023368, 3, 0.82]

];

function initialize() {
  var mapOptions = {
    zoom: 10,
    center: new google.maps.LatLng(49.12409645133197, -122.49365941835936),
    mapTypeId: google.maps.MapTypeId.SATELLITE
  };
  var map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);



  var marker, i;
  for (i = 0; i < locations.length; i++) {
    marker = new google.maps.Marker({
      position: new google.maps.LatLng(locations[i][0], locations[i][1]),
      icon: createMarker(30, 20, locations[i][2].toString()),
      category: locations[i][3],
      map: map,
    });
    visitmarkers.push(marker);
  }


  var marker2, j;
  for (j = 0; j < GPlocations.length; j++) {
    marker2 = new google.maps.Marker({
      position: new google.maps.LatLng(GPlocations[j][0], GPlocations[j][1]),
      icon: createMarker2(30, 20, GPlocations[j][2].toString(), GPlocations[j][3].toString()),
      map: map,
    });
    marker2.setVisible(false);
    GPmarkers.push(marker2);
  }


  var circleOptions = {
    strokeColor: '#FF0000',
    strokeOpacity: 0.8,
    strokeWeight: 2,
    fillColor: '#FF0000',
    fillOpacity: 0.35,
    map: map,
    //49.036831,-122.713252
    //49.151317,-122.845335
    center: new google.maps.LatLng(49.15, -122.84),
    radius: 3000
  };
  Circle = new google.maps.Circle(circleOptions);

}


//filterMarkers = function () {
filterMarkers = function(category) {

  for (i = 0; i < locations.length; i++) {
    marker = visitmarkers[i];
    //   If is same category or category not picked
    if (marker.category == category || category.length === 0) {
      marker.setVisible(true);
    }
    // Categories don't match 
    else {
      marker.setVisible(false);
    }
  }
};

filterGPMarkers = function(checked) {
  var i = 0;
  for (i = 0; i < GPlocations.length; i++) {
    marker = GPmarkers[i];
    if (document.getElementById("checkbox_GPs").checked == true) {
      marker.setVisible(true);
    } else {
      marker.setVisible(false);
    }
  }
};

date = function() {
 //window.alert("Hello");
  $('#thedate').datepicker({
    dateFormat: 'dd-mm-yy',
    altField: '#thealtdate',
    altFormat: 'yy-mm-dd'
  });
};


google.maps.event.addDomListener(window, 'load', initialize);
